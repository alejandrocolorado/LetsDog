<style>
    .profile {
        background-image: url(https://cdn2.iconfinder.com/data/icons/flat-ui-4/100/Camera-512.png);
        border-radius: 100%;
        width: 80px;
        height: 80px;
        background-position: center;
        background-color: rgba(0, 0, 0, 0.1);
        background-size: 70%;
        background-repeat: no-repeat;
        margin: 0 auto 20px;
        transition: all 0.3s ease-in-out;
        transition-property: background-color, box-shadow;
        cursor: pointer;
    }

    .profile:hover {
        background-color: rgba(0, 0, 0, 0.4);
    }

    .profile.cover {
        background-color: rgba(255, 255, 255, 1);
        background-size: cover;
        box-shadow: 0px 0px 19px 0px rgba(0, 0, 0, 0.32);
    }

    #formBtn {
        margin: 0 auto;
        display: block;
    }

    #photo,
    #submitBtn {
        display: none;
    }
</style>

<h2> Sign Up </h2>

{{#if err}}
<p class="error-message">
    {{ err }}
</p>
{{/if}}

<form action="/signup" method="post">

    <div>
        <label for="email-input"> Email </label>
        <input type="email" name="email" id="email-input" placeholder="e.g., hola@hola.com">
    </div>

    <div>
        <label for="password-input"> Password </label>
        <input type="password" name="password" id="password-input" placeholder="e.g., ••••••••••••">
    </div>

    <button> Continue </button>
</form>

<form enctype="multipart/form-data" id="form">
    <div id="addPhoto" class="profile"></div>
    <input id="photo" type="file" name="photo">
    <input id="submitBtn" type="submit">
</form>

<p>
    Already have an account?
    <a href="/login">
        Log in.
    </a>
</p>

<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>

    const userData = {
        email: '',
        password: '',
    };
    const dogData = {
        photo: '',
        name: '',
        age: '',
        sex: '',
        breed: '',
        size: '',
        behavior: { withDogs: '', withPeople: '' },
    };

    const emailExists = () => {

        console.log(emailInput.value)
        axios
            .post('/manage/validate-user', { email: emailInput.value })
            .then((response) => {
                if (!response.data) {
                    console.log(response.data)
                } else {
                    console.log('no existes');
                    userData.email = emailInput.value;
                }
            });
    }

    const emailInput = document.getElementById('email-input');

    emailInput.addEventListener('blur', emailExists)

    const updateDogProfile = () => {

        const fileToUpload = document.querySelector('#photo').files[0];

        let config = {
            headers: {
                'Content-Type': 'multipart/form-data'
            }
        }

        let data = new FormData()
        data.append('image', fileToUpload);

        axios.post('/manage/validate-dog-photo', data, config)
            .then((response) => {
                console.log(response)
                const dogProfileUrl = response.data;
                document.getElementById('addPhoto').style.backgroundImage = `url(${dogProfileUrl})`;
                document.getElementById('addPhoto').classList.add('cover')

            })
            .catch(err => {
                console.error("Image post failed: ", err)
            })
    };

    const sendForm = (e) => {
        e.preventDefault();
        console.log('hola..')
        updateDogProfile()
    }

    document.getElementById('addPhoto').addEventListener('click', () => {
        document.getElementById('photo').click()
    })
    document.getElementById('form').addEventListener('submit', sendForm);
    document.getElementById('photo').addEventListener('change', () => {
        document.getElementById('submitBtn').click()
    });

</script>